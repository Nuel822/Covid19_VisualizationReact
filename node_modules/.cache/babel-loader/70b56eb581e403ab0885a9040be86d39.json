{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { deepMix, each } from '@antv/util';\nimport { DIRECTION } from '../constant';\nimport { getFactTitleConfig } from '../util/facet';\nimport { Facet } from './facet';\n/**\n * @ignore\n * 镜像分面\n */\n\nvar Matrix =\n/** @class */\nfunction (_super) {\n  __extends(Matrix, _super);\n\n  function Matrix() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Matrix.prototype.getDefaultCfg = function () {\n    return deepMix({}, _super.prototype.getDefaultCfg.call(this), {\n      type: 'matrix',\n      showTitle: false,\n      columnTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this)),\n      rowTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this))\n    });\n  };\n\n  Matrix.prototype.render = function () {\n    _super.prototype.render.call(this);\n\n    if (this.cfg.showTitle) {\n      this.renderTitle();\n    }\n  };\n\n  Matrix.prototype.afterEachView = function (view, facet) {\n    this.processAxis(view, facet);\n  };\n\n  Matrix.prototype.beforeEachView = function (view, facet) {};\n\n  Matrix.prototype.generateFacets = function (data) {\n    var _a = this.cfg,\n        fields = _a.fields,\n        type = _a.type; // 矩阵中行列相等，等于指定的字段个数\n\n    var rowValuesLength = fields.length;\n    var columnValuesLength = rowValuesLength;\n    var rst = [];\n\n    for (var i = 0; i < columnValuesLength; i++) {\n      var columnField = fields[i];\n\n      for (var j = 0; j < rowValuesLength; j++) {\n        var rowField = fields[j];\n        var facet = {\n          type: type,\n          data: data,\n          region: this.getRegion(rowValuesLength, columnValuesLength, i, j),\n          columnValue: columnField,\n          rowValue: rowField,\n          columnField: columnField,\n          rowField: rowField,\n          columnIndex: i,\n          rowIndex: j,\n          columnValuesLength: columnValuesLength,\n          rowValuesLength: rowValuesLength\n        };\n        rst.push(facet);\n      }\n    }\n\n    return rst;\n  };\n  /**\n   * 设置 x 坐标轴的文本、title 是否显示\n   * @param x\n   * @param axes\n   * @param option\n   * @param facet\n   */\n\n\n  Matrix.prototype.getXAxisOption = function (x, axes, option, facet) {\n    // 最后一行显示\n    if (facet.rowIndex !== facet.rowValuesLength - 1) {\n      return __assign(__assign({}, option), {\n        label: null,\n        title: null\n      });\n    }\n\n    return option;\n  };\n  /**\n   * 设置 y 坐标轴的文本、title 是否显示\n   * @param y\n   * @param axes\n   * @param option\n   * @param facet\n   */\n\n\n  Matrix.prototype.getYAxisOption = function (y, axes, option, facet) {\n    // 第一列显示\n    if (facet.columnIndex !== 0) {\n      return __assign(__assign({}, option), {\n        title: null,\n        label: null\n      });\n    }\n\n    return option;\n  };\n  /**\n   * facet title\n   */\n\n\n  Matrix.prototype.renderTitle = function () {\n    var _this = this;\n\n    each(this.facets, function (facet, facetIndex) {\n      var columnIndex = facet.columnIndex,\n          rowIndex = facet.rowIndex,\n          columnValuesLength = facet.columnValuesLength,\n          rowValuesLength = facet.rowValuesLength,\n          columnValue = facet.columnValue,\n          rowValue = facet.rowValue,\n          view = facet.view; // top\n\n      if (rowIndex === 0) {\n        var config = deepMix({\n          position: ['50%', '0%'],\n          content: columnValue\n        }, getFactTitleConfig(DIRECTION.TOP), _this.cfg.columnTitle);\n        view.annotation().text(config);\n      } // right\n\n\n      if (columnIndex === columnValuesLength - 1) {\n        var config = deepMix({\n          position: ['100%', '50%'],\n          content: rowValue\n        }, getFactTitleConfig(DIRECTION.RIGHT), _this.cfg.rowTitle);\n        view.annotation().text(config);\n      }\n    });\n  };\n\n  return Matrix;\n}(Facet);\n\nexport default Matrix;","map":{"version":3,"sources":["../../src/facet/matrix.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { deepMix, each } from '@antv/util';\nimport { DIRECTION } from '../constant';\nimport { getFactTitleConfig } from '../util/facet';\nimport { Facet } from './facet';\n/**\n * @ignore\n * 镜像分面\n */\nvar Matrix = /** @class */ (function (_super) {\n    __extends(Matrix, _super);\n    function Matrix() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Matrix.prototype.getDefaultCfg = function () {\n        return deepMix({}, _super.prototype.getDefaultCfg.call(this), {\n            type: 'matrix',\n            showTitle: false,\n            columnTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this)),\n            rowTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this))\n        });\n    };\n    Matrix.prototype.render = function () {\n        _super.prototype.render.call(this);\n        if (this.cfg.showTitle) {\n            this.renderTitle();\n        }\n    };\n    Matrix.prototype.afterEachView = function (view, facet) {\n        this.processAxis(view, facet);\n    };\n    Matrix.prototype.beforeEachView = function (view, facet) {\n    };\n    Matrix.prototype.generateFacets = function (data) {\n        var _a = this.cfg, fields = _a.fields, type = _a.type;\n        // 矩阵中行列相等，等于指定的字段个数\n        var rowValuesLength = fields.length;\n        var columnValuesLength = rowValuesLength;\n        var rst = [];\n        for (var i = 0; i < columnValuesLength; i++) {\n            var columnField = fields[i];\n            for (var j = 0; j < rowValuesLength; j++) {\n                var rowField = fields[j];\n                var facet = {\n                    type: type,\n                    data: data,\n                    region: this.getRegion(rowValuesLength, columnValuesLength, i, j),\n                    columnValue: columnField,\n                    rowValue: rowField,\n                    columnField: columnField,\n                    rowField: rowField,\n                    columnIndex: i,\n                    rowIndex: j,\n                    columnValuesLength: columnValuesLength,\n                    rowValuesLength: rowValuesLength,\n                };\n                rst.push(facet);\n            }\n        }\n        return rst;\n    };\n    /**\n     * 设置 x 坐标轴的文本、title 是否显示\n     * @param x\n     * @param axes\n     * @param option\n     * @param facet\n     */\n    Matrix.prototype.getXAxisOption = function (x, axes, option, facet) {\n        // 最后一行显示\n        if (facet.rowIndex !== facet.rowValuesLength - 1) {\n            return __assign(__assign({}, option), { label: null, title: null });\n        }\n        return option;\n    };\n    /**\n     * 设置 y 坐标轴的文本、title 是否显示\n     * @param y\n     * @param axes\n     * @param option\n     * @param facet\n     */\n    Matrix.prototype.getYAxisOption = function (y, axes, option, facet) {\n        // 第一列显示\n        if (facet.columnIndex !== 0) {\n            return __assign(__assign({}, option), { title: null, label: null });\n        }\n        return option;\n    };\n    /**\n     * facet title\n     */\n    Matrix.prototype.renderTitle = function () {\n        var _this = this;\n        each(this.facets, function (facet, facetIndex) {\n            var columnIndex = facet.columnIndex, rowIndex = facet.rowIndex, columnValuesLength = facet.columnValuesLength, rowValuesLength = facet.rowValuesLength, columnValue = facet.columnValue, rowValue = facet.rowValue, view = facet.view;\n            // top\n            if (rowIndex === 0) {\n                var config = deepMix({\n                    position: ['50%', '0%'],\n                    content: columnValue,\n                }, getFactTitleConfig(DIRECTION.TOP), _this.cfg.columnTitle);\n                view.annotation().text(config);\n            }\n            // right\n            if (columnIndex === columnValuesLength - 1) {\n                var config = deepMix({\n                    position: ['100%', '50%'],\n                    content: rowValue,\n                }, getFactTitleConfig(DIRECTION.RIGHT), _this.cfg.rowTitle);\n                view.annotation().text(config);\n            }\n        });\n    };\n    return Matrix;\n}(Facet));\nexport default Matrix;\n//# sourceMappingURL=matrix.js.map"]},"metadata":{},"sourceType":"module"}